This folder contains all the code that was used for preprocessing the data.
* `Tox21_preprocessing_I.Rmd` â€“ combining the `.smiles` files from https://tripod.nih.gov/tox21/challenge/data.jsp and deduplicating the data.
* `Tox21_preprocessing_II.ipynb` - cleaning the dataset by removing the compounds unsuitable for LC/ESI/HRMS analysis or, if possible, modifying their structures to make them compatible.
* `SMILES2fingerprint_features.Rmd` - calculating the fingerprint features corresponding to the molecular properties calculated by SIRIUS+CSI:FingerID for all the compounds in the cleaned Tox21 dataset (obtained from `Tox21_preprocessing_II.ipynb`) based on their SMILES notations. (In order to build classification models that are applicable regardless of which ionisation mode (positive or negative) was used during the HRMS analysis, only the overlapping features were kept for training the models after the computation process.)
* `Mass_spectrometric_preprocessing_I.Rmd` - extracting high-resolution tandem mass spectra (MS2 data) from MassBank (version 2022.06a; https://zenodo.org/record/7148841#.ZGEK_3ZBxpI).
* `Split_data_real_life_test_set.ipynb` - matching the extracted MS2 data with cleaned Tox21 dataset based on standardised SMILES and selecting the subset from compounds with toxicity and MS2 data (10% of all the compounds) available and assigning them as a real-life test set. Also, adding the information about calculated true fingerprint features (obtained from  `SMILES2fingerprint_features.Rmd`) to all of the compounds in both the `real-life test set` and `training/intermediate testing set`.
* `Split_data_train_and_intermediate_test_sets.Rmd` - removing the highly correlated fingerprint features and features with zero or near-zero variance (using `training/intermediate testing set` generated in `Split_data_real_life_test_set.ipynb`); splitting the obtained data into training and intermediate test sets.
* `MassBank2SIRIUS.Rmd` - generating the `.ms` files for all the compounds in the real-life test set, calculating the fingerprint features with SIRIUS+CSI:FingerID (version 5.6.3) and generating the final real-life test set file, that contains all the information needed for final evaluation of the models.
